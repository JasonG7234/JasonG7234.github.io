<!DOCTYPE HTML>
<html lang="en">
<head>
	<!-- Global site tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-M96NVP2DZ7"></script>
	<script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-M96NVP2DZ7');
	</script>
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<title>Hacking OnlySports.Live</title>
	<link rel="icon" href="../images/icon.png">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
	<link type="text/css" rel="stylesheet" href="../main.css"/>
	<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,600' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
</head>
<body id="projects_body" class="body">
	<header id="header-1">
		<a href="../index.html">
			<img id="logo" src="../images/icon.png" alt="logo">
		</a>
		<nav id="nav">
			<a href="../about.html" class="internal_links">About</a>
			<a href="../resume.html" class="internal_links">Resume</a>
        <a href="../blogs.html" class="internal_links">Blogs</a>
			<a href="../nba_draft.html" class="internal_links">NBA Draft</a>
			<a href="../contact.html" class="internal_links">Contact</a>
		</nav>
	</header>
	<header id="header-2">
		<nav class="navbar custom-toggler" aria-label="logo">
			<a href="../index.html">
				<img id="logo" src="../images/icon.png" alt="logo">
			</a>
			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <a class="nav-item nav-link" href="../about.html">About</a>
                    <a class="nav-item nav-link" href="../resume.html">Resume</a>
                    <a class="nav-item nav-link" href="../blogs.html">Blogs</a>
                    <a class="nav-item nav-link" href="../nba_draft.html">NBA Draft</a>
                    <a class="nav-item nav-link" href="../contact.html">Contact</a>
                </div>
			</div>
		</nav>
	</header>
	<main id="projects_main">
    <div class="container">
        <div class="row">
            <div class="col-sm-3 col-sm-offset-1">
                <div class="sticky-top">
                    <div class="sidebar_module sidebar_module_inset">
                        <h4>About</h4>
                        <p>On this page, I'll document some of the unique and fun projects/interests of mine. Inspired (mostly) by <a href="https://tinyprojects.dev">tinyprojects.dev</a>.</p>
                    </div>
                    <div class="sidebar_module">
                        <h4>Archives</h4>
                        <ol class="list_unstyled">
                            <li><a href="buying-a-house.html">Buying a House</a></li>
                            <li><a href="job-hunt.html">Software Dev Job Hunt</a></li>
                            <li><a href="startups.html">Tech Startup Culture</a></li>
                            <li><a href="gambling-bot.html">Sports Gambling Bot</a></li>
                            <li><a href="website.html">Making this Website</a></li>
                            <li><a href="draft-model.html">NBA Draft ML Model</a></li>
                            <li><a href="magic-mirror.html">Magic Mirror</a></li>
                        </ol>
                    </div>
                </div>
            </div><!-- / blog-sidebar -->
            <div class="col-sm-8 blog_main">
                <div class="blog_post">
                    <h2 class="blog_post_title">Hacking past a subscription service to download my basketball games</h2>
                    <p class="blog_post_meta">August 17, 2024</p>
                    <p>In the beginning of 2024, I started coaching a 9th grade basketball team. I have been playing basketball since I was old enough to walk, and finally wanted to follow the family tradition and try to coach.</p>
                    <p>I instantly fell in love with it. Admittedly, my teams didn't have much success in the beginning, starting on a 17-game losing streak with me as the active head coach. No, that's not a joke. 17 games.</p>
                    <br><center><img class="blog-pic" src="../images/project-blogs/hacking-onlysports-subscription/coaching-twitter-meme.png"/></center><br>
                    <figcaption>My team technically won the first game I ever coached, but I wasn't the head coach. For my first game, I had some help from two star players not on my roster and a veteran coach to show me the ropes.</figcaption><br />
                    <p>But it was so rewarding. After the first season, I went into season #2 with a lot of ideas on how to improve. I had some returnees mix well with some new incoming talent, and the team was in a much better state. I would go into practice each week with different offensive concepts and fun drills for the kids to improve.</p>
                    <p>However, the practices were too short. It was one hour a week, and then we'd go right into the game and forget a lot of what we worked on in practice. There wasn't enough time to get the guys to the next level.</p>
                    <p>I found out most of the games were being recorded by a service called <a href="https://onlysports.live/channel/msccjb">OnlySports.live</a>. Once I noticed this, I immediately signed up for a subscription. I only have one hour per week of practice, but I can send out the game film after every game, edit out team concepts of good or bad defensive rotations, and even on occasion send individual film out to guys who are struggling.</p>
                    <h3>And this worked well. The team got better and really appreciated having the film availabile.</h3><br>
                    <p>But this wouldn't be worthy of writing about if that was the entire story.</p>
                    <p>The subscription was expensive. $20/month to essentially download 4 games a month seemed unnecessary, especially considering every <a href="https://www.forbes.com/sites/alistaircharlton/2023/09/07/bmw-drops-controversial-heated-seats-subscription-to-refocus-on-software-services/">service is a subscription service in 2024</a>.</p>
                    <p>I've been really inspired recently about bug bounties and white hat hacking. To summarize, there are very technically-inclined engineers out there who poke around common websites and services to find bugs. The goal is to exploit these small bugs into bigger vulnerabilities, but <i>not for criminal reasons</i>. Usually, these vulnerabilities are reported back to the company to be fixed, and the company generally would pay the engineer for finding the issue.</p>
                    <p><a href="https://gist.github.com/hackermondev/68ec8ed145fcee49d2f5e2b9d2cf2e52">This story about a bug with customer support service Zendesk</a> and <a href="https://samcurry.net/hacking-kia">this post around hacking newer Kia cars with just a license plate number</a>(!!!) are fascinating looks on ways in which "hacking" can be done ethically. </p>
                    <h3>So I decided to try my hand at it.</h3>
                    <hr>
                    <p>I thought on it for a little while and figured that OnlySports was a good candidate for poking around. I knew it was a newer service and I was pretty frustrated with the price point, so I hoped I'd be able to hack something together.</p>
                    <p>Let's start out with the use case. The day after every game, I'd log into the OnlySports site and find the video with the game. Then, I'd screen record the game from my computer & upload it to YouTube.</p>
                    <br><center><img class="blog-pic" src="../images/project-blogs/hacking-onlysports-subscription/onlysports-video-page.png"/></center><br>
                    <p>So, as a software engineer, I opened Chrome's Dev Tools to check the HTML layout. I clicked the element selector tool (circled in the screenshot above) to select just the video within the HTML: </p>
                    <code>&lt;video _ngcontent-ook-c173="" playsinline="playsinline" ref="video" class="vjs-tech" id="vjs_video_3_html5_api" tabindex="-1" preload="metadata" src="https://1733451806.rsc.cdn77.org/msccjb/2d6d6287-d824-4c8b-b2ee-4900241f9187/2d6d6287-d824-4c8b-b2ee-4900241f9187_original.mp4"&gt;&lt;/video&gt;</code><br/><br/>
                    <p>That <code>src</code> tag is the most useful, as it is the underlying video file. In this case, the src URL is a specific CDN, or content delivery network, that is hosting the video file. The purpose of CDNs in the networking infrastructure is beyond the point of this post, but think of it as a faster way to deliver data to specific regions. Regardless, the CDN host has what appears to be some random integers in <code>1733451806</code> and then again in <code>cdn77</code>. At the end of the URL is a <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier">GUID</a>, which seems to represent the video id (starting with 2d6).</p>
                    <p>Doing the same process for a couple more videos, I found out that the URL changed <i>but only in terms of the id</i>. Going back multiple days at multiple times, the CDN host was exactly the same. This means that theoretically, if I could find a video's id without an account, I should be able to navigate directly to the CDN to download the video.</a></p>
                    <p>In an incognito window, I went to the OnlySports homepage. I was able to navigate to the same video as I used above, but this time I was met with a different view. </a></p>
                    <br><center><img class="blog-pic" src="../images/project-blogs/hacking-onlysports-subscription/onlysports-video-incognito-page.png"/></center><br>
                    <p>Of course, I have to have a subscription to view the video. However, as you can see highlighted in the Dev Tools window, we do get an <code>img</code> element that includes the GUID from previously. With this in mind, we feasibly can bypass this subscription service and still access the videos!</p>
                    <hr>
                    <h3>So, let's summarize the method here.</h3><br/>
                    <ol>
                        <li>Find the game in question. Let's say for simplicity, I am looking for a game at 8PM on Saturday October 12th. Without being logged in, I can head to <a href="https://onlysports.live/channel/msccjb/see-all/recent-videos">the OnlySports homepage</a> and find the video in question.</a></li>
                        <li>Find the video id in the HTML, either using Chrome's Dev Tools or separate Python code to grab.</li>
                        <li>Use the video id in the URL for the CDN host to download the specific game.</li>
                    </ol>
                    <p>While this was a consistent enough process, I wouldn't be a software engineer if I didn't spend far too long writing code to do this all for me. Using Python, I can easily grab the video id automatically with <a href="https://www.selenium.dev/documentation/webdriver/">Selenium Webdriver</a>:</p>
                    <code>
                        def <span style="color:gray">get_video_id</span>(<span style="color:#FFB2B2">url</span>):<br/>
                            &nbsp;&nbsp;&nbsp;&nbsp;driver = webdriver.Chrome().get(<span style="color:#FFB2B2">url</span>)<br/>
                            &nbsp;&nbsp;&nbsp;&nbsp;video_element = driver.find_element(By.CLASS_NAME, 'blocked-video')<br/>
                            &nbsp;&nbsp;&nbsp;&nbsp;video_img = video_element.find_element(By.CSS_SELECTOR, "img.ng-star-inserted")<br/>

                            &nbsp;&nbsp;&nbsp;&nbsp;src = video_img.get_attribute('src')<br/>
                            &nbsp;&nbsp;&nbsp;&nbsp;return src.split("msccjb/")[1].split('/')[0]<br/>
                    </code><br/>
                    <p>Then, I can use a handy tool called <a href="https://www.ffmpeg.org/">ffmpeg</a> to download the video from a URL at a certain time, and I can get Python to execute it through a subprocess.</p>
                    <code>
                        def <span style="color:gray">download_video</span>(<span style="color:#FFB2B2">video_id</span>, <span style="color:#A5FFC9">start_time</span>, <span style="color:#556B2F">end_time</span>):<br/>
                        &nbsp;&nbsp;&nbsp;&nbsp;url = f"https://1733451806.rsc.cdn77.org/msccjb/{<span style="color:#FFB2B2">video_id</span>}/{<span style="color:#FFB2B2">video_id</span>}_original.mp4"<br/>
                        &nbsp;&nbsp;&nbsp;&nbsp;command = ["ffmpeg", "-y", "-i", url, "-ss", <span style="color:#A5FFC9">start_time</span>, "-to", <span style="color:#556B2F">end_time</span>, "-c", "copy", "output.mp4"]<br/><br/>
                        
                        &nbsp;&nbsp;&nbsp;&nbsp;subprocess.run(command)<br/>
                        &nbsp;&nbsp;&nbsp;&nbsp;p = subprocess.Popen(command)<br/>
                        &nbsp;&nbsp;&nbsp;&nbsp;p.wait()<br/>
                    </code><br/>
                    <p>That's all that is really necessary for the Python code. With the above, I can download any video through the site. Next steps would be to parse the schedule page everyday to grab the game URLs without them needing to be input, or to <a href="https://developers.google.com/youtube/v3/guides/uploading_a_video">use Google's API to automatically upload the game to YouTube</a>. </p>
                    <hr>
                    <h3>What's next?</h3><br />
                    <p>I started this story talking about my desire for white hat hacking, and an emphasis on ethical hacking. I think I've found a clear exploit here, and I've been struggling to decide how to handle it.</p>
                    <p>On one hand, I despise all of the unnecessary subscriptions that exist today, and all of the ways in which </p>
                    <p>But the reason, to me, why I hate subscription services is become companies are capitalistic and want to squeeze every dollar out of the consumer. If I don't report this vulnerability, and instead profit off it, would I not be guilty of the same thing? </p>
                    <h3>In the end, after all this introspection, I reported the vulnerability to OnlySports.live.</h3><br />
                </div><!-- /.blog_post -->
            </div>
        </div>
    </div>
    </main>
	<footer id="projects_footer">Got any questions? Feel free to <a href="../contact.html">shoot me a message</a>.<br>
    This blog format was templated from <a href="https://codepen.io/msatlewal/pen/MEPLLw">this link.</a></footer>
  <script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.3/js/bootstrap.bundle.min.js" integrity="sha512-iceXjjbmB2rwoX93Ka6HAHP+B76IY1z0o3h+N1PeDtRSsyeetU3/0QKJqGyPJcX63zysNehggFwMC/bi7dvMig==" crossorigin="anonymous"></script>
  </body>
</html>
